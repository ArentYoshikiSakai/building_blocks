# 3D積木アプリケーション仕様書

## 1. プロジェクト概要

### 1.1 プロジェクト名
「ブロックワールド」- 直感的3D積木体験アプリケーション

### 1.2 背景
既存の市場には、子供向けの簡単で直感的な操作ができる3D積木WEBアプリケーションが不足しています。実際の積木のように自由に組み立て、創造性を育む環境をデジタル空間で提供するアプリケーションが求められています。

### 1.3 目的
- 子供たちにパソコン上で3D積木体験を提供する
- 直感的なマウス操作で簡単に積木を配置・組み合わせられるようにする
- 創造性や空間認識能力を育成する
- 作品を保存・共有できる環境を提供する

## 2. 技術スタック

### 2.1 フロントエンド
- React.js
- TypeScript
- Three.js (3Dレンダリング)
- React Three Fiber (React向けThree.jsラッパー)
- Zustand/Redux (状態管理)
- CSS Modules/Styled-components (スタイリング)

### 2.2 バックエンド
- Node.js
- Express.js
- MongoDB/Firebase (プロジェクト保存用)

### 2.3 開発環境
- Vite/Create React App
- ESLint/Prettier
- Jest/React Testing Library (テスト)

## 3. 機能要件

### 3.1 基本機能
1. **ユーザー管理**
   - ゲストアクセス（保存機能制限あり）
   - アカウント作成・ログイン機能
   - ユーザープロフィール管理

2. **プロジェクト管理**
   - 新規プロジェクト作成
   - プロジェクト一覧表示
   - プロジェクトの保存・読み込み
   - プロジェクトの共有

3. **3D積木エディタ**
   - 3D空間での積木配置
   - カメラ視点の移動・回転
   - ズームイン/アウト

### 3.2 積木関連機能
1. **積木要素**
   - 立方体：基本的な積木ブロック
   - 直方体：長方形のブロック（複数サイズあり）
   - 円柱：丸い柱形状
   - 三角形：三角屋根形状
   - 半円：アーチ形状
   - 特殊パーツ：車輪、窓、ドア等

2. **積木操作**
   - ドラッグ＆ドロップでの配置
   - クリック＆ドラッグでの移動
   - 右クリックでの回転
   - ダブルクリックでの削除
   - グリッドスナップ機能（正確な配置補助）
   - 積木の色変更

3. **プロジェクト設定**
   - 背景色/テーマ変更
   - 地面テクスチャ変更
   - 光源の設定（昼/夜モード）

### 3.3 拡張機能
1. **テンプレート**
   - 始めやすいテンプレートプロジェクト（家、お城など）
   - 段階的なチュートリアル

2. **共有・エクスポート**
   - 作品のスクリーンショット撮影
   - SNS共有機能
   - 3Dモデルエクスポート（STL/GLBフォーマット）

3. **コラボレーション**
   - 友達との共同編集（将来的な拡張）
   - 作品ギャラリー・コミュニティ機能

## 4. 非機能要件

### 4.1 ユーザビリティ
- 子供でも直感的に操作できるUI設計
- 年齢に応じた難易度設定
- ヘルプ・ガイド機能
- レスポンシブデザイン（タブレット対応）
- 操作音・効果音によるフィードバック

### 4.2 パフォーマンス
- 60FPS以上の安定した動作
- 複雑な構造物（100ブロック以上）でもスムーズな操作
- 初期ロード時間5秒以内
- ブラウザキャッシュの活用

### 4.3 セキュリティ
- ユーザーデータの暗号化
- XSS対策
- CSRF対策
- 子供向けコンテンツのモデレーション

## 5. 画面設計

### 5.1 メイン画面
1. **ホーム画面**
   - プロジェクト一覧
   - 新規プロジェクト作成ボタン
   - ログイン/ユーザー情報

2. **エディタ画面**
   - 3D表示領域（メイン）
   - 積木パレット（左サイドバー）
   - プロジェクト設定（右サイドバー）
   - ツールバー（上部）

3. **ギャラリー画面**
   - 公開された作品一覧
   - 人気/新着フィルター
   - インスピレーションセクション

### 5.2 UI要素
1. **操作ツールバー**
   - 選択ツール
   - 移動ツール
   - 回転ツール
   - 拡大/縮小ツール
   - 削除ツール
   - 視点リセットボタン

2. **積木パレット**
   - カテゴリ別積木表示
   - カラーピッカー
   - サイズ調整スライダー

3. **プロジェクト設定パネル**
   - 保存ボタン
   - 背景設定
   - 環境設定
   - エクスポートオプション

## 6. データモデル

### 6.1 ユーザーモデル
```typescript
interface User {
  id: string;
  username: string;
  email: string;
  password: string; // ハッシュ化
  avatar?: string;
  createdAt: Date;
  projects: Project[];
}
```

### 6.2 プロジェクトモデル
```typescript
interface Project {
  id: string;
  name: string;
  description?: string;
  createdAt: Date;
  updatedAt: Date;
  ownerId: string;
  isPublic: boolean;
  blocks: Block[];
  settings: ProjectSettings;
}
```

### 6.3 ブロックモデル
```typescript
interface Block {
  id: string;
  type: BlockType; // 'cube', 'rectangle', 'cylinder', 'triangle', etc.
  position: Vector3;
  rotation: Euler;
  scale: Vector3;
  color: string;
  properties?: Record<string, any>; // 特殊パーツ用の追加プロパティ
}

type BlockType = 'cube' | 'rectangle' | 'cylinder' | 'triangle' | 'arch' | 'wheel' | 'window' | 'door';
```

### 6.4 プロジェクト設定モデル
```typescript
interface ProjectSettings {
  backgroundColor: string;
  groundTexture: string;
  lightingMode: 'day' | 'night' | 'custom';
  gridEnabled: boolean;
  gridSize: number;
  snapToGrid: boolean;
}
```

## 7. 開発ロードマップ

### フェーズ1: MVPリリース
- 基本的な積木配置機能
- 3〜5種類の基本積木
- 単一プロジェクト保存
- ゲストモード

## 8. ビジネスルール

1. コンテンツポリシー
   - 不適切な作品の禁止
   - コンテンツモデレーション

2. 使用制限
   - ゲストユーザー：1プロジェクト、30ブロックまで
   - 登録ユーザー：10プロジェクト、制限なしブロック
   - プレミアムユーザー（将来拡張）：無制限

3. プライバシー設定
   - プロジェクトの公開/非公開設定
   - 子供のプライバシー保護ガイドライン遵守

## 9. テスト戦略

1. **単体テスト**
   - コンポーネント単位のテスト
   - ユーティリティ関数のテスト

2. **統合テスト**
   - ユーザーフロー
   - APIとの連携

3. **パフォーマンステスト**
   - 大量のブロック配置時の動作確認
   - メモリリーク検証

4. **ユーザビリティテスト**
   - 子供ユーザーによる実際の利用テスト
   - フィードバック収集と改善


以上の仕様に基づき開発を進めることで、子供たちが直感的に操作できる3D積木体験アプリケーションを実現します。